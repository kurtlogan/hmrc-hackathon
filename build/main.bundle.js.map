{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/calibration/controls.js","webpack:///./src/speech-to-text/onend.js","webpack:///./src/speech-to-text/onerror.js","webpack:///./src/speech-to-text/onresult.js","webpack:///./src/speech-to-text/onstart.js","webpack:///./src/speech-to-text/controls.js","webpack:///./src/webgazer/precision_store_points.js","webpack:///./src/webgazer/setup.js","webpack:///./src/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","textField","dot","running","dotTop","parseInt","style","top","dotLeft","left","counter","dir","cleanup","document","body","removeChild","undefined","webgazer","createElement","innerText","position","appendChild","width","height","backgroundColor","borderRadius","updateDotPosition","setTimeout","window","innerWidth","innerHeight","recordScreenPosition","element","event","interim","resultIndex","results","length","transcript","startSpeechText","recog","webkitSpeechRecognition","continuous","interimResults","onstart","_onstart2","default","onerror","_onerror2","onresult","_onresult2","onend","_onend2","lang","start","stopSpeechText","stop","store_points_var","xPast50","Array","yPast50","store_points_variable","stop_storing_points_variable","store_points","x","y","k","get_points","past50","_precision_store_points","_precision_store_points2","canvas","getElementById","setRegression","setTracker","setGazeListener","data","clock","begin","removeMouseEventListeners","showPredictionPoints","setup","video","display","margin","background","params","imgWidth","imgHeight","overlay","id","faceOverlay","border","cl","getTracker","clm","drawLoop","requestAnimFrame","getContext","clearRect","getCurrentPosition","draw","checkIfReady","isReady","_controls","onload","Error","_setup2","querySelector","addEventListener","_controls3","speechToTextElements","querySelectorAll","_loop","onfocus","onblur"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n","let textField;\nlet dot;\nlet running = false;\n\nlet dotTop = () => dot ? parseInt(dot.style.top) : 0\nlet dotLeft = () => dot ? parseInt(dot.style.left) : 0\n\nlet speed = 15;\nlet maxIterations = 4\nlet counter = 0;\n\nlet spawnRedDot = () => {\n  if (!dot) {\n    dot = document.createElement('div');\n    dot.style.width = \"20px\"\n    dot.style.height = \"20px\"\n    dot.style.position = 'fixed'\n    dot.style.left = \"10px\"\n    dot.style.top = \"10px\"\n    dot.style.backgroundColor = 'red'\n    dot.style.borderRadius = '50%'\n\n    document.body.appendChild(dot)\n  }\n\n  return dot\n}\n\nlet dir = \"right\"\nlet updateDotPosition = (webgazer) => () => {\n  if(counter >= maxIterations) {\n    dot.style.backgroundColor = 'green'\n    setTimeout(cleanup, 2500)\n    return;\n  }\n\n  if(dot) {\n    if(dotLeft() >= window.innerWidth - 50 && dir == \"right\") {\n      dir = \"down\"\n      counter++\n    } else if(dotTop() >= window.innerHeight - 50 && dir == \"down\") {\n      dir = \"left\"\n      counter++\n    } else if(dotLeft() <= 10 && dir == \"left\") {\n      dir = \"up\"\n      counter++\n    } else if(dotTop() <= 10 && dir == \"up\") {\n      dir = \"right\"\n      counter++\n    }\n\n    switch (dir) {\n      case \"right\": dot.style.left = (dotLeft() + speed) + \"px\"; break;\n      case \"down\": dot.style.top = (dotTop() + speed) + \"px\"; break;\n      case \"left\": dot.style.left = (dotLeft() - speed) + \"px\"; break;\n      case \"up\": dot.style.top = (dotTop() - speed) + \"px\"; break;\n    }\n\n    webgazer.recordScreenPosition(dotLeft(), dotTop())\n  }\n\n  setTimeout(updateDotPosition(webgazer), 75)\n}\n\nlet cleanup = () => {\n  running = false;\n  counter = 0;\n  document.body.removeChild(textField);\n  document.body.removeChild(dot);\n  textField = undefined\n  dot = undefined\n}\n\nexport default (webgazer) => () => {\n  if(!running) {\n    running = true;\n\n    if(!textField) {\n      textField = document.createElement(\"div\")\n      textField.innerText = \"Stare at the red dot, follow it with you eyes until it turns green\"\n      textField.style.position = \"fixed\"\n      textField.style.top = \"50%\"\n      textField.style.left = \"50%\"\n\n      document.body.appendChild(textField);\n    }\n\n    spawnRedDot()\n    updateDotPosition(webgazer)()\n  }\n}\n","export default (element) => () => {}\n","export default (element) => () => {}\n","export default (element) => (event) => {\n  var interim = '';\n\n  for(var i = event.resultIndex; i < event.results.length; ++i) {\n    interim += event.results[i][0].transcript;\n  }\n\n  element.value = interim;\n}\n","export default (element) => () => {}\n","import onstart from './onstart'\nimport onresult from './onresult'\nimport onerror from './onerror'\nimport onend from './onend'\n\nlet startSpeechText = (element) => {\n  var recog = new webkitSpeechRecognition();\n  recog.continuous = false;\n  recog.interimResults = true;\n\n  recog.onstart = onstart(element);\n  recog.onerror = onerror(element);\n  recog.onresult = onresult(element);\n  recog.onend = onend(element);\n\n  recog.lang = \"en-GB\";\n  recog.start();\n}\n\nlet stopSpeechText = (recog) => {\n  recog.stop();\n}\n\nexport { startSpeechText, stopSpeechText }\n","export default (window) => {\n  window.store_points_var = false;\n  window.xPast50 = new Array(50);\n  window.yPast50 = new Array(50);\n\n  /*\n   * Sets store_points to true, so all the occuring prediction\n   * points are stored\n   */\n  window.store_points_variable = function(){\n    store_points_var = true;\n  }\n\n  /*\n   * Sets store_points to false, so prediction points aren't\n   * stored any more\n   */\n  window.stop_storing_points_variable = function(){\n    store_points_var = false;\n  }\n\n  /*\n   * Stores the position of the fifty most recent tracker preditions\n   */\n  window.store_points = function(x, y, k) {\n    xPast50[k] = x;\n    yPast50[k] = y;\n  }\n\n  /*\n   * Returns the stored tracker prediction points\n   */\n  window.get_points = function() {\n    var past50 = new Array(2);\n    past50[0] = xPast50;\n    past50[1] = yPast50;\n    return past50;\n  }\n}\n","import precision_store_points from './precision_store_points'\n\nexport default (window, webgazer) => {\n  precision_store_points(window);\n\n  var canvas = document.getElementById(\"plotting_canvas\");\n\n  if(canvas) {\n    //start the webgazer tracker\n     webgazer.setRegression('ridge') /* currently must set regression and tracker */\n         .setTracker('clmtrackr')\n         .setGazeListener(function(data, clock) {\n           //   console.log(data); /* data is an object containing an x and y key which are the x and y prediction coordinates (no bounds limiting) */\n           //   console.log(clock); /* elapsed time in milliseconds since webgazer.begin() was called */\n         })\n         .begin()\n         .removeMouseEventListeners()\n         .showPredictionPoints(true); /* shows a square every 100 milliseconds where current prediction is */\n\n     var width = 320;\n     var height = 240;\n     var topDist = '0px';\n     var leftDist = '0px';\n\n     //Set up the webgazer video feedback.\n     var setup = function() {\n         //Set up video variable to store the camera feedback\n         var video = document.getElementById('webgazerVideoFeed');\n\n         //Position the camera feedback to the top left corner.\n         video.style.display = 'block';\n         video.style.position = 'fixed';\n         video.style.top = topDist;\n         video.style.left = leftDist;\n\n         //Set up the video feedback box size\n         video.width = width;\n         video.height = height;\n         video.style.margin = '0px';\n         video.style.background = '#222222';\n         webgazer.params.imgWidth = width;\n         webgazer.params.imgHeight = height;\n\n         //Set up the main canvas. The main canvas is used to calibrate the webgazer.\n         var overlay = document.createElement('canvas');\n         overlay.id = 'overlay';\n\n         //Setup the size of canvas\n         overlay.style.position = 'fixed';\n         overlay.width = width;\n         overlay.height = height;\n         overlay.style.top = topDist;\n         overlay.style.left = leftDist;\n         overlay.style.margin = '0px';\n\n         //Draw the face overlay on the camera video feedback\n         var faceOverlay = document.createElement('face_overlay');\n         faceOverlay.id = 'faceOverlay';\n         faceOverlay.style.position = 'fixed';\n         faceOverlay.style.top = '59px';\n         faceOverlay.style.left = '107px';\n         faceOverlay.style.border = 'solid';\n\n         document.body.appendChild(overlay);\n         document.body.appendChild(faceOverlay);\n\n         canvas.width = window.innerWidth;\n         canvas.height = window.innerHeight;\n         canvas.style.position = 'fixed';\n\n         var cl = webgazer.getTracker().clm;\n\n         //This function draw the face of the user frame.\n         function drawLoop() {\n             requestAnimFrame(drawLoop);\n             overlay.getContext('2d').clearRect(0,0,width,height);\n             if (cl.getCurrentPosition()) {\n                 cl.draw(overlay);\n             }\n         }\n         drawLoop();\n     };\n\n     function checkIfReady() {\n         if (webgazer.isReady()) {\n             setup();\n         } else {\n             setTimeout(checkIfReady, 100);\n         }\n     }\n     setTimeout(checkIfReady, 100);\n   }\n}\n","import webgazerSetup from './webgazer/setup'\nimport {startSpeechText, stopSpeechText} from './speech-to-text/controls'\nimport startCalibration from './calibration/controls'\n\nwindow.onload = () => {\n  if(typeof(window.webgazer) === 'undefined') {\n    throw new Error(\"webgazer not found!\");\n  } else {\n    webgazerSetup(window, window.webgazer);\n  }\n\n  let calibrateButton = document.querySelector(\"#calibrate\")\n\n  if(calibrateButton) {\n    document.addEventListener('click', startCalibration(window.webgazer));\n  }\n\n  /*\n   * Bind speech to text to all elements on page load\n   */\n  let speechToTextElements = document.querySelectorAll(\"input[type='text'], textarea\");\n  for (let i = 0; i < speechToTextElements.length; i++) {\n    let element = speechToTextElements[i];\n    element.onfocus = () => {\n      let recog = startSpeechText(element);\n      element.onblur = () => stopSpeechText(recog);\n    }\n  }\n}\n"],"sourceRoot":""}